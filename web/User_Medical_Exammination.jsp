

<%@page import="java.sql.ResultSet"%>
<%@page import="java.sql.PreparedStatement"%>
<%@page import="context.DBContext"%>
<%@page import="java.sql.Connection"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">

        <title>Inner Page - Medilab Bootstrap Template</title>
        <meta content="" name="description">
        <meta content="" name="keywords">

        <!-- Favicons -->
        <link href="assets/img/favicon.png" rel="icon">
        <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

        <!-- Vendor CSS Files -->
        <link href="assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
        <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet">
        <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
        <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
        <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
        <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
        <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

        <!-- Template Main CSS File -->
        <link href="assets/css/style.css" rel="stylesheet">
        <style>
            .main {
                padding-left: var(--sidebar-size);
            }

            .main-header {
                height: var(--main-header-height);
                display: flex;
                align-items: center;
                padding: 20px;
                background-color: var(--box-bg);
                box-shadow: var(--shadow);
            }

            .dark .main-header {
                border-bottom: 2px solid var(--border-color);
            }

            .mobile-toggle {
                display: none;
            }

            .main-title {
                text-transform: capitalize;
                font-size: 1.5rem;
            }

            .main-content {
                padding: 20px;
            }

            .box {
                background-color: var(--box-bg);
                padding: 20px;
                border: 0.5px solid var(--border-color);
                border-radius: var(--box-border-radius);
            }

            .box-hover:hover {
                border-color: var(--main-color);
            }

            .counter-title {
                margin-bottom: 20px;
                text-transform: capitalize;
            }

            .counter-info {
                display: flex;
                align-items: center;
                justify-content: space-between;
                font-size: 2rem;
                font-weight: 700;
            }

            .counter-info i {
                color: var(--main-color);
            }

            .box-header {
                text-transform: capitalize;
                font-size: 1.25rem;
                font-weight: 700;
            }

            .box-body {
                padding: 20px 0;
            }

            .product-list {
                list-style-type: none;
            }

            .product-list-item {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 15px 0;
            }

            .item-info {
                display: flex;
                align-items: center;
            }

            .item-info img {
                width: 50px;
                height: 50px;
                border-radius: 10px;
                margin-right: 10px;
            }

            .product-name,
            .product-sales {
                font-weight: 600;
                text-transform: capitalize;
            }

            .product-name {
                margin-bottom: 5px;
            }

            .product-sales {
                margin-top: 5px;
            }

            .text-second {
                color: var(--text-second-color);
            }

            .item-sale-info {
                text-align: right;
            }

            .f-height {
                height: 100%;
            }

            table {
                width: 100%;
                min-width: 1000px;
            }

            .order-owner {
                display: flex;
                align-items: center;
                text-transform: capitalize;
                font-weight: 500;
            }

            .order-owner img {
                width: 45px;
                height: 45px;
                border-radius: 50%;
                margin-right: 15px;
            }

            table thead tr {
                text-align: left;
            }

            table th,
            table td {
                padding: 20px 0;
                border-bottom: 1px solid var(-border-color);
            }

            .order-status {
                padding: 5px 15px;
                border-radius: 5px;
                font-weight: 500;
            }

            .order-ready {
                color: #2a59d1;
                background-color: rgba(62, 121, 247, 0.1);
            }

            .order-shipped {
                color: #00ab6f;
                background-color: rgba(4, 209, 130, 0.1);
            }
            .order-shipped1 {
                color: #00ab6f;
                background-color: #FFCCFF;
            }

            .payment-status {
                display: flex;
                align-items: center;
            }

            .payment-status .dot {
                width: 10px;
                height: 10px;
                border-radius: 50%;
                margin-right: 10px;
            }

            .payment-paid .dot {
                background-color: green;
            }
            .payment-cancel .dot {
                background-color: red;
            }
            .payment-success .dot {
                background-color: #2caae1;
            }
            .payment-pending .dot {
                background-color: #ffc542;
            }

            .overflow-scroll {
                overflow-y: auto;
            }

            .overlay {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.7);
                display: none;
            }

            .overlay.active {
                display: block;
            }
        </style>
        <!-- =======================================================
        * Template Name: Medilab - v4.7.1
        * Template URL: https://bootstrapmade.com/medilab-free-medical-bootstrap-theme/
        * Author: BootstrapMade.com
        * License: https://bootstrapmade.com/license/
        ======================================================== -->
    </head>

    <body>

        <!-- ======= Top Bar ======= -->
        <div id="topbar" class="d-flex align-items-center fixed-top">
            <div class="container d-flex justify-content-between">
                <div class="contact-info d-flex align-items-center">
                    <i class="bi bi-envelope"></i> <a href="mailto:contact@example.com">contact@example.com</a>
                    <i class="bi bi-phone"></i> +1 5589 55488 55
                </div>
                <div class="d-none d-lg-flex social-links align-items-center">
                    <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
                    <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                    <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
                    <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></i></a>
                </div>
            </div>
        </div>

        <!-- ======= Header ======= -->
        <jsp:include page="assets/module/header.jsp" flush="true"/>
        <!-- End Header -->

        <main id="main" style="padding: 100px 0 0">



            <section class="">
                <div class="container">
                    <div class="col-md-12">
                        <div class="col-md-12">
                            <!-- ORDERS TABLE -->
                            <div class="box">
                                <div class="box-header">
                                    My Reservation
                                </div>
                                <div class="box-body overflow-scroll" style=" overflow-y: auto;">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>reservation_id</th>
                                                <th>user_id</th>
                                                <th>total_price</th>
                                                <th>note</th>
                                                <th>reservation_status</th>
                                                <th>created_date</th>
                                            </tr>
                                        </thead>
                                        <tbody>

                                            <%
                                                try {
                                                    Connection conn = new DBContext().getConnection();
                                                    String sql = "SELECT r.[reservation_id],r.[user_id],r.[total_price],r.[note],r.[reservation_status],r.[created_date]\n"
                                                            + "FROM [ChildrenCare].[dbo].[reservation] r JOIN [reservation_detail]  rd \n"
                                                            + "ON r.reservation_id = rd.reservation_id  \n"
                                                            + "  WHERE r.[user_id] = ? \n";
                                                    PreparedStatement ps = conn.prepareStatement(sql);
                                                    ps.setString(1, request.getAttribute("uid").toString());
                                                    ResultSet rs = ps.executeQuery();
                                                    while (rs.next()) {
                                            %>
                                            <tr>
                                                <td>#ID: <%=rs.getString(1)%></td>
                                                <td>
                                                    <span class="order-status order-ready"><%=rs.getString(2)%></span>
                                                </td>
                                                <td>
                                                    <span class="order-status order-ready"><%=rs.getString(3)%></span>
                                                </td>
                                                <td>
                                                    <%=rs.getString(4)%>
                                                </td>
                                                <td>
                                                    <%=rs.getString(5)%>
                                                </td>
                                                <td>
                                                    <%=rs.getString(6)%>
                                                </td>
                                            </tr>
                                            <%                                                    }
                                                } catch (Exception e) {
                                                }
                                            %>


                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- END ORDERS TABLE -->
                        </div>

                    </div>
                </div>
                </div>
            </section>

        </main><!-- End #main -->

        <!-- ======= Footer ======= -->
        <jsp:include page="assets/module/footer.jsp" flush="true"/>
        <!-- End Footer -->

        <div id="preloader"></div>
        <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

        <!-- Vendor JS Files -->
        <script src="assets/vendor/purecounter/purecounter.js"></script>
        <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
        <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
        <script src="assets/vendor/php-email-form/validate.js"></script>

        <!-- Template Main JS File -->
        <script src="assets/js/main.js"></script>
        <script>
                                                            function submit(res_id) {
                                                                let text = "Are you want to submit?\nEither Submit or Cancel.";
                                                                if (confirm(text) == true) {
                                                                    window.location = "/project_swp391/submitreservation?res_id=" + res_id;
                                                                } else {
                                                                    text = "You canceled!";
                                                                }
                                                            }
        </script>

    </body>

</html>